=================================================================================
Simple policy to (i) Enable digesting MISP intel files into Zeek 
		(ii) Log the alerts in Romain's JSON format 
=================================================================================

Following functionality are provided by the script
--------------------------------------------------
::
        1) ability to read and digest MISP fed intel files into zeek
	2) ability to log hits in json format spec'ed out by Romain Wartel

Installation
------------
	zeek-pkg install zeek/initconf/INTEL_MISP
	or
	@load  INTEL_MISP/scripts


Detailed Notes:
---------------
Detail Alerts and descriptions: Following alerts are generated by the script:
******************************************************************************


This should generate `misp.log` which is in json format 

On `jq` the following output should be expected : 

{
  "ioc": "1drv.ms",
  "timestamp_rfc3339ns": 2025-02-12T16:11:38.658234000Z,
  "detection": "*TCP Traffic*:: `22[.]23.24.25:64447` -> `13[.]107.42.12:443` [X509::IN_CERT]\n*Total bytes*: 327.00B up/8.88KB down",
  "ioc_type": "Intel::DOMAIN",
  "uid": "C2lExp2LUWugdbTvYb",
  "url": ""
}


Example notice: 
***************************
There should be two log files generated:

1) intel.log - as expected and obvious one
2) misp.log - json formatted intel.log


Note: We do have capability to filter what gets logged into misp.log

see: `redef Intel::MISP::ignore` variable in the script.




